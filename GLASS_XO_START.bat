@echo off
chcp 65001 >nul
title üî• Glass XO - –ó–∞–ø—É—Å–∫ –∏–≥—Ä—ã
color 0A

echo.
echo üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•
echo üî•                   GLASS XO ONLINE                     üî•
echo üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•
echo.

echo üõ°Ô∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ñ–∞–π—Ä–≤–æ–ª–∞ –¥–ª—è –≤—Å–µ—Ö –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–≤...
netsh advfirewall firewall add rule name="Glass XO Port 3000" dir=in action=allow protocol=TCP localport=3000 >nul 2>&1
netsh advfirewall firewall add rule name="Glass XO Node.js" dir=in action=allow program=node >nul 2>&1
netsh advfirewall firewall add rule name="Glass XO RadMin" dir=in action=allow remoteip=26.0.0.0/8 protocol=TCP localport=3000 >nul 2>&1
netsh advfirewall firewall add rule name="Glass XO Local" dir=in action=allow remoteip=192.168.0.0/16 protocol=TCP localport=3000 >nul 2>&1
echo ‚úÖ –§–∞–π—Ä–≤–æ–ª –Ω–∞—Å—Ç—Ä–æ–µ–Ω –¥–ª—è –≤—Å–µ—Ö —Å–µ—Ç–µ–π

echo üîÑ –û—Å–≤–æ–±–æ–∂–¥–∞–µ–º –ø–æ—Ä—Ç 3000...
for /f "tokens=5" %%a in ('netstat -aon ^| findstr :3000 ^| findstr LISTENING') do (
    taskkill /PID %%a /F >nul 2>&1
)
echo ‚úÖ –ü–æ—Ä—Ç –æ—Å–≤–æ–±–æ–∂–¥–µ–Ω

echo.
echo üìã –ê–î–†–ï–°–ê –î–õ–Ø –ü–û–î–ö–õ–Æ–ß–ï–ù–ò–Ø:
echo.

echo üíª –î–õ–Ø –í–ê–° (—Ö–æ—Å—Ç —Å–µ—Ä–≤–µ—Ä–∞):
echo    üîó http://localhost:3000
echo    üîó http://127.0.0.1:3000
echo.

echo üåê –ê–î–†–ï–°–ê –î–õ–Ø –î–†–£–ó–ï–ô –í –î–†–£–ì–ò–• –ì–û–†–û–î–ê–•:
echo    üéØ –†–ê–î–ú–ò–ù VPN: http://26.207.157.149:3000 ^(–û–°–ù–û–í–ù–û–ô –ê–î–†–ï–°^)
echo    üè† –õ–û–ö–ê–õ–¨–ù–ê–Ø –°–ï–¢–¨: http://192.168.1.111:3000 ^(–≤ —Ç–æ–π –∂–µ —Å–µ—Ç–∏^)
echo.

echo üìã –ü–†–û–í–ï–†–ö–ê IP –ê–î–†–ï–°–û–í:
for /f "tokens=2 delims=:" %%a in ('ipconfig ^| findstr /c:"IPv4"') do (
    set "ip=%%a"
    setlocal EnableDelayedExpansion
    set "ip=!ip: =!"
    
    if "!ip:~0,3!"=="26." (
        echo    ‚úÖ RadMin VPN –∞–∫—Ç–∏–≤–µ–Ω: !ip!
    )
    
    if "!ip:~0,3!"=="192" (
        echo    ‚úÖ –õ–æ–∫–∞–ª—å–Ω–∞—è —Å–µ—Ç—å –∞–∫—Ç–∏–≤–Ω–∞: !ip!
    )
    
    if "!ip:~0,3!"=="10." (
        echo    ‚úÖ –î–æ–º–∞—à–Ω—è—è —Å–µ—Ç—å –∞–∫—Ç–∏–≤–Ω–∞: !ip!
    )
    
    endlocal
)

echo.
echo üéÆ –ò–ù–°–¢–†–£–ö–¶–ò–Ø –î–õ–Ø –î–†–£–ì–ê:
echo    1Ô∏è‚É£ –û—Ç–ø—Ä–∞–≤—å –¥—Ä—É–≥—É –∞–¥—Ä–µ—Å: http://26.207.157.149:3000
echo    2Ô∏è‚É£ –î—Ä—É–≥ –¥–æ–ª–∂–µ–Ω –æ—Ç–∫—Ä—ã—Ç—å —ç—Ç–æ—Ç –∞–¥—Ä–µ—Å –≤ –±—Ä–∞—É–∑–µ—Ä–µ
echo    3Ô∏è‚É£ –£–±–µ–¥–∏—Å—å —á—Ç–æ —É –¥—Ä—É–≥–∞ —Ç–æ–∂–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω RadMin VPN
echo    4Ô∏è‚É£ –û–±–∞ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω—ã –∫ –æ–¥–Ω–æ–π RadMin —Å–µ—Ç–∏
echo    5Ô∏è‚É£ –ò–≥—Ä–∞–π—Ç–µ –æ–Ω–ª–∞–π–Ω –≤–º–µ—Å—Ç–µ!
echo.
echo üîß –ï–°–õ–ò –ù–ï –†–ê–ë–û–¢–ê–ï–¢:
echo    ‚ùó –ü—Ä–æ–≤–µ—Ä—å —á—Ç–æ RadMin VPN –ø–æ–¥–∫–ª—é—á–µ–Ω
echo    ‚ùó –î—Ä—É–≥ —Ç–æ–∂–µ –¥–æ–ª–∂–µ–Ω –∏–º–µ—Ç—å RadMin VPN
echo    ‚ùó –í—Ä–µ–º–µ–Ω–Ω–æ –æ—Ç–∫–ª—é—á–∏ –∞–Ω—Ç–∏–≤–∏—Ä—É—Å/–±—Ä–∞–Ω–¥–º–∞—É—ç—Ä
echo    ‚ùó –ò—Å–ø–æ–ª—å–∑—É–π —Ç–æ—á–Ω—ã–π –∞–¥—Ä–µ—Å: 26.207.157.149:3000
echo.

echo üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•
echo üî•                 –ó–ê–ü–£–°–ö –°–ï–†–í–ï–†–ê                       üî•
echo üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•
echo.

rem –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ Node.js
where node >nul 2>&1
if %errorlevel% neq 0 (
    echo ‚ùå Node.js –Ω–µ –Ω–∞–π–¥–µ–Ω!
    echo üí° –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Node.js —Å https://nodejs.org
    pause
    exit /b 1
)

rem –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ server.js
if not exist "server.js" (
    echo ‚ùå –§–∞–π–ª server.js –Ω–µ –Ω–∞–π–¥–µ–Ω!
    echo üí° –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –≤—ã –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –ø–∞–ø–∫–µ
    pause
    exit /b 1
)

echo üöÄ –û—Ç–∫—Ä—ã–≤–∞–µ–º –±—Ä–∞—É–∑–µ—Ä...
start http://localhost:3000

echo üî• –ó–∞–ø—É—Å–∫–∞–µ–º —Å–µ—Ä–≤–µ—Ä...
node server.js

rem –ï—Å–ª–∏ —Å–µ—Ä–≤–µ—Ä –∑–∞–≤–µ—Ä—à–∏–ª—Å—è - –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –æ—à–∏–±–∫—É
echo.
echo ‚ùå –°–µ—Ä–≤–µ—Ä –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω!
pause 